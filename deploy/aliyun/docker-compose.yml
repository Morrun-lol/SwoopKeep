services:
  swoopkeep-api:
    image: ${SWOOPKEEP_API_IMAGE:-swoopkeep-api:latest}
    build:
      context: ../../api
      dockerfile: Dockerfile
    container_name: swoopkeep-api
    restart: unless-stopped
    ports:
      - "3001:3001"
    environment:
      - PORT=3001
      - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
      - DEEPSEEK_BASE_URL=${DEEPSEEK_BASE_URL:-https://api.deepseek.com/v1}
      - DEEPSEEK_CHAT_MODEL=${DEEPSEEK_CHAT_MODEL:-deepseek-chat}
    healthcheck:
      test: ["CMD", "sh", "-lc", "wget -q -O - http://127.0.0.1:3001/api/ai/health | grep -q success" ]
      interval: 10s
      timeout: 3s
      retries: 10
